{"version":3,"file":"commonHelpers.js","sources":["../src/js/refs.js","../src/js/pixayApi.js","../src/js/render-function","../src/js/scrollBy.js","../src/js/buttonService.js","../src/main.js"],"sourcesContent":["export const refs = {\n  form: document.querySelector('.form'),\n  input: document.querySelector('.input'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  searchBtn: document.querySelector('.btn'),\n  btnMore: document.querySelector('.load-btn'),\n  // loadMoreBtn: document.querySelector('[data-action=\"load-more\"]'),\n  preloader: document.getElementById(\"preloader\"),\n};","const BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '41991385-9b19b8bb3d6f1491499417d17';\n\nexport function getImages({ query, page = 1, per_page }) {\n    const url = `${BASE_URL}?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true`;\n  \n  return axios.get(url, {\n    params: {\n      page,\n      per_page,\n    }\n  })\n    .then(({data})=>data);\n}\n      \n\n\n","export function createMarkup(hits, gallery) {\n    const markup = hits\n      .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) =>\n          `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n            <ul class=\"gallery-info\">\n              <li class=\"gallery-info-item\">Likes: <span class=\"descr-span\">${likes}</span></li>\n              <li class=\"gallery-info-item\">Views: <span class=\"descr-span\">${views}</span></li>\n              <li class=\"gallery-info-item\">Comments: <span class=\"descr-span\">${comments}</span></li>\n              <li class=\"gallery-info-item\">Downloads: <span class=\"descr-span\">${downloads}</span></li>\n            </ul> \n          </a>\n        </li>`\n      )\n    .join('');\n   gallery.insertAdjacentHTML(\"beforeend\", markup);\n}\n  \n","export function scrollBy() {\n  window.scrollBy({\n    top:\n      2 *\n      document.querySelector('.gallery-item').getBoundingClientRect().height,\n    behavior: 'smooth',\n  });\n}","const hiddenClass = \"is-hidden\";\n\n// функції, які керують різними станами кнопки завантажити більше\n\nfunction hide(button) {\n  button.classList.add(hiddenClass);\n}\n\nfunction show(button) {\n  button.classList.remove(hiddenClass);\n}\n\nfunction enable(button, preloader) {\n  loader.classList.add(hiddenClass);\n  button.disabled = false;\n}\n\nfunction disable(button, preloader) {\n  loader.classList.remove(hiddenClass);\n  button.disabled = true;\n}\n\nexport default { hide, show, enable, disable };\n\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { refs } from './js/refs';\nimport { getImages } from './js/pixayApi';\nimport { createMarkup } from './js/render-function';\nimport { scrollBy } from './js/scrollBy';\nimport buttonService from './js/buttonService';\n\nconst simplyGallery = new SimpleLightbox('.gallery-item a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n});\n\nconst queryParams = {\n  query: '',\n  page: 1,\n  maxPage: 0,\n  per_page: 15,\n};\n\nrefs.form.addEventListener('submit', handleSearch);\nasync function handleSearch(event) {\n  event.preventDefault();\n  refs.gallery.innerHTML = '';\n\n  queryParams.page = 1;\n  queryParams.query = refs.input.value.trim();\n  \n  showLoader();\n  \n  if (!queryParams.query) {\n    createMessage(\"The search field can't be empty! Please, enter your request!\");\n    return;\n    hideLoader();\n  }\n\n  function createMessage(message) {\n    iziToast.show({\n      class: 'error-svg',\n      position: 'topRight',\n      icon: 'error-svg',\n      message: message,\n      maxWidth: '432',\n      messageColor: '#fff',\n      messageSize: '16px',\n      backgroundColor: '#EF4040',\n      close: false,\n      closeOnClick: true,\n    });\n  }\n\n  try {\n    const {hits, totalHits } = await getImages(queryParams);\n    queryParams.maxPage = Math.ceil(totalHits / queryParams.per_page);\n    createMarkup(hits, refs.gallery);  \n    // refs.gallery.insertAdjacentHTML('beforeend', createMarkup(hits));\n    gallery.refresh();\n\n    if (hits.length > 0 && hits.length !== totalHits) {\n      buttonService.show(refs.btnMore); // показуємо кнопку, якщо є результати від серверу і якщо ми не показали всі резульати які є (наприклад, якщо тотал резалст = 100 і кількість артіклів = 100)\n      refs.btnMore.addEventListener(\"click\", handleLoadMore);\n      hideLoader();\n      \n    } else {\n      buttonService.hide(refs.btnMore);\n      createMessage(\"We are sorry, but you've reached the end of search results\");\n    }\n\n  } catch (error) {\n    // createMessage(\"Sorry, there is a problem with connection with the server\");\n    console.log(error)\n  \n  } finally {\n    hideLoader();\n    refs.form.reset();\n    scrollBy();\n  }\n\n  // обробка натискання на кнопку завантажити більше\n  async function handleLoadMore() {\n    queryParams.page += 1;\n    showLoader();\n   \n    // перед початком запиту - показуємо лоадер і блокуємо кнопку\n  buttonService.disable(refs.btnMore);\n    try {\n      const { hits } = await getImages(queryParams);\n      createMarkup(hits, refs.gallery);//малюємо розмітку\n      \n      // refs.gallery.refresh();\n\n      // if (data.hits.length > 0) {\n      //   showButton();\n      //   refs.btnMore.addEventListener('click', handleLoadMore);\n      // } else {\n      //   hideButton();\n      //   createMessage(\"We're sorry, but you've reached the end of search results\");\n      // }\n\n    } catch (error) {\n      console.log(error);\n      // createMessage(\"Sorry, there is a problem with connection with the server\");\n    \n    } finally {\n      hideLoader();     // після запиту - ховаємо лоадер і розблоковуємо кнопку\n    buttonService.enable(refs.btnMore);\n     \n      // і обовʼязково після натискання на кнопку та закінчення запиту перевіряємо, якщо ми зараз знаходимось на останній сторінці - то ховаємо кнопку і видаляємо обробник подій!\n    if (queryParams.page === queryParams.maxPage) {\n      buttonService.hide(refs.btnMore);\n      refs.btnMore.removeEventListener(\"click\", handleLoadMore);\n      createMessage(\"We are sorry, but you've reached the end of search results\");\n    }\n             \n      scrollBy();\n    }\n  }\n\n  function hideLoader() {\n    setTimeout(() => {\n        refs.loader.classList.add('is-hidden');\n        }, 500);\n  };\n\n  function showLoader() {\n        refs.loader.classList.remove('is-hidden');\n  };\n  \n  \n}\n"],"names":["refs","BASE_URL","API_KEY","getImages","query","page","per_page","url","data","createMarkup","hits","gallery","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","scrollBy","hiddenClass","hide","button","show","enable","preloader","disable","buttonService","SimpleLightbox","queryParams","handleSearch","event","showLoader","createMessage","message","iziToast","totalHits","handleLoadMore","hideLoader","error"],"mappings":"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"}