{"version":3,"file":"commonHelpers.js","sources":["../src/js/refs.js","../src/js/pixayApi.js","../src/js/render-function","../src/js/scrollBy.js","../src/main.js"],"sourcesContent":["export const refs = {\n  form: document.querySelector('.form'),\n  input: document.querySelector('.input'),\n  gallery: document.querySelector('.gallery'),\n  searchBtn: document.querySelector('.btn'),\n  button: document.querySelector('.button'),\n  loadMoreBtn: document.querySelector('[data-action=\"load-more\"]'),\n  loader: document.querySelector(\".loader\"),\n};","const BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '41991385-9b19b8bb3d6f1491499417d17';\n\nexport function getImages({ query, page = 1, per_page }) {\n    const url = `${BASE_URL}?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true`;\n  \n  return axios.get(url, {\n    params: {\n      page,\n      per_page,\n    }\n  })\n    .then(({data})=>data);\n}\n      \n\n\n","export function createMarkup(hits) {\n  return hits\n    .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) =>\n          `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n            <ul class=\"gallery-info\">\n              <li class=\"gallery-info-item\">Likes: <span class=\"descr-span\">${likes}</span></li>\n              <li class=\"gallery-info-item\">Views: <span class=\"descr-span\">${views}</span></li>\n              <li class=\"gallery-info-item\">Comments: <span class=\"descr-span\">${comments}</span></li>\n              <li class=\"gallery-info-item\">Downloads: <span class=\"descr-span\">${downloads}</span></li>\n            </ul> \n          </a>\n        </li>`\n      )\n    .join('');\n}\n  \n","export function scrollBy() {\n  window.scrollBy({\n    top:\n      2 *\n      document.querySelector('.gallery-item').getBoundingClientRect().height,\n    behavior: 'smooth',\n  });\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { refs } from './js/refs';\nimport { getImages } from './js/pixayApi';\nimport { createMarkup } from './js/render-function';\nimport { scrollBy } from './js/scrollBy';\n\n\nconst simplyGallery = new SimpleLightbox('.gallery-item a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n});\n\nconst queryParams = {\n  query: '',\n  page: 1,\n  maxPage: 0,\n  per_page: 15,\n};\n\nrefs.form.addEventListener('submit', handleSearch);\n\nasync function handleSearch(event) {\n  showLoader();\n  event.preventDefault();\n  refs.gallery.innerHTML = '';\n  queryParams.page = 1;\n\n  const form = event.currentTarget;\n  queryParams.query = form.elements.query.value.trim();\n  \n \n  if (!queryParams.query) {\n    createMessage(\"The search field can't be empty! Please, enter your request!\");\n    hideLoader();\n    return;\n  }\n \n  function createMessage(message) {\n    iziToast.show({\n      class: 'error-svg',\n      position: 'topRight',\n      icon: 'error-svg',\n      message: message,\n      maxWidth: '432',\n      messageColor: '#fff',\n      messageSize: '16px',\n      backgroundColor: '#EF4040',\n      close: false,\n      closeOnClick: true,\n    });\n  }\n\n  try {\n    const { hits, totalHits } = await getImages(queryParams);\n    queryParams.maxPage = Math.ceil(totalHits / queryParams.per_page);\n    \n    refs.gallery.insertAdjacentHTML(\"beforeend\", createMarkup(hits));\n    simplyGallery.refresh();\n    hideLoader();\n\n    if (hits.length === 0) {\n      createMessage(`Sorry, there are no images matching your search query. Please, try again!`);\n      hideLoader();\n      \n      } else if (hits.length > 0 && hits.length !== totalHits) {\n      showButton();\n      refs.loadMoreBtn.addEventListener(\"click\", handleLoadMore);\n      hideLoader();\n      \n    } else {\n      hideButton();\n      createMessage(\"We are sorry, but you've reached the end of search results\");\n    }\n\n  } catch (error) {\n    createMessage(\"Sorry, there is a problem with connection with the server\");\n      \n  } finally {\n    hideLoader();\n    form.reset();\n    scrollBy();\n  }\n  \n  function hideLoader() {\n      setTimeout(() => {\n        refs.loader.classList.add('is-hidden');\n      }, 1000);\n    };\n\n  function showLoader() {\n      refs.loader.classList.remove('is-hidden');\n    };\n  \n  function hideButton() {\n      refs.loadMoreBtn.classList.add('is-hidden');\n    }\n\n  function showButton() {\n      refs.loadMoreBtn.classList.remove('is-hidden');\n    }\n\n}\n\nasync function handleLoadMore() {\n    queryParams.page += 1;\n    showLoader();\n    refs.loadMoreBtn.disabled = true;\n        \n    try {\n      const { hits } = await getImages(queryParams);\n      refs.gallery.insertAdjacentHTML(\"beforeend\", createMarkup(hits));\n      simplyGallery.refresh();\n\n    } catch (error) {\n      createMessage(\"Sorry, there is a problem with connection with the server\");\n    \n    } finally {\n      hideLoader();\n      refs.loadMoreBtn.disabled = false;\n      \n      if (queryParams.page === queryParams.maxPage) {\n        hideLoader();\n        hideButton();\n        refs.loadMoreBtn.removeEventListener(\"click\", handleLoadMore);\n        createMessage(\"We are sorry, but you've reached the end of search results\");\n      }\n      scrollBy();\n    }\n  function hideLoader() {\n      setTimeout(() => {\n        refs.loader.classList.add('is-hidden');\n      }, 1000);\n    };\n\n  function showLoader() {\n      refs.loader.classList.remove('is-hidden');\n    };\n  \n  function hideButton() {\n      refs.loadMoreBtn.classList.add('is-hidden');\n    }\n\n  function showButton() {\n      refs.loadMoreBtn.classList.remove('is-hidden');\n    }\n}\n  \n\n \n  \n  \n\n"],"names":["refs","BASE_URL","API_KEY","getImages","query","page","per_page","url","data","createMarkup","hits","webformatURL","largeImageURL","tags","likes","views","comments","downloads","scrollBy","simplyGallery","SimpleLightbox","queryParams","handleSearch","event","showLoader","form","createMessage","hideLoader","message","iziToast","totalHits","showButton","handleLoadMore","hideButton"],"mappings":"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"}