{"version":3,"file":"commonHelpers.js","sources":["../src/js/refs.js","../src/js/pixayApi.js","../src/js/render-function","../src/js/scrollBy.js","../src/main.js"],"sourcesContent":["export const refs = {\n  form: document.querySelector('.form'),\n  input: document.querySelector('.input'),\n  gallery: document.querySelector('.gallery'),\n  button: document.querySelector('.button'),\n  loader: document.querySelector('.loader'),\n};","export async function getImages(query, page) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '41991385-9b19b8bb3d6f1491499417d17';\n    \n  const res = await axios.get(BASE_URL, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page: page,\n    },\n  });\n    return res.data;\n}\n\n\n","export function createMarkup(hits) {\n  return hits\n    .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) =>\n          `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n            <ul class=\"gallery-info\">\n              <li class=\"gallery-info-item\">Likes: <span class=\"descr-span\">${likes}</span></li>\n              <li class=\"gallery-info-item\">Views: <span class=\"descr-span\">${views}</span></li>\n              <li class=\"gallery-info-item\">Comments: <span class=\"descr-span\">${comments}</span></li>\n              <li class=\"gallery-info-item\">Downloads: <span class=\"descr-span\">${downloads}</span></li>\n            </ul> \n          </a>\n        </li>`\n      )\n    .join('');\n}\n  \n","export function scrollBy() {\n  window.scrollBy({\n    top:\n      2 *\n      document.querySelector('.gallery-item').getBoundingClientRect().height,\n    behavior: 'smooth',\n  });\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { refs } from './js/refs';\nimport { getImages } from './js/pixayApi';\nimport { createMarkup } from './js/render-function';\nimport { scrollBy } from './js/scrollBy';\n\n\nconst simplyGallery = new SimpleLightbox('.gallery-item a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n});\n\nconst queryParams = {\n  query: '',\n  page: 0,\n  maxPage: 0,\n  per_page: 15,\n};\n\nrefs.form.addEventListener('submit', handleSearch);\nrefs.button.addEventListener(\"click\", handleLoadMore);\n\nqueryParams.maxPage = Math.ceil(queryParams.totalHits / queryParams.per_page);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  \n  queryParams.query = event.currentTarget.elements.query.value.trim();\n  queryParams.page = 1;\n  \n  showLoader();  \n  hideButton();\n\n  refs.gallery.innerHTML = '';\n     \n  if (!queryParams.query) {\n    createMessage(\"The search field can't be empty! Please, enter your request!\");\n    hideLoader();\n    return;\n  }\n\n  try {\n    const res = await getImages(queryParams.query, queryParams.page);\n    if (res.hits.length === 0) {\n      createMessage('Sorry, there are no images matching your search query. Please try again!');\n      refs.form.reset();\n      hideLoader();\n      return;\n    }\n    refs.gallery.insertAdjacentHTML('beforeend', createMarkup(res.hits));\n    simplyGallery.refresh();\n            \n    if (res.hits.length >= 15) {\n      hideLoader();  \n      showButton();\n    } else {\n      hideButton();\n      createMessage(\"We're sorry, but you've reached the end of search results\");\n    }\n    \n    refs.form.reset();\n      \n  } catch (error) {\n    hideButton();\n    refs.gallery.innerHTML = '';\n    createMessage(\"Sorry, there is a problem with connection with the server\");\n    \n  } finally {\n    hideLoader();\n    refs.form.reset();\n    if (queryParams.page === queryParams.maxPage) {\n      createMessage(\"We're sorry, but you've reached the end of search results!\");\n    }\n  }\n}\n\nasync function handleLoadMore() {\n    queryParams.page += 1;\n    showButton();\n    refs.button.disabled = true;\n        \n    try {\n      const res = await getImages(queryParams.query, queryParams.page);\n      refs.button.disabled = false;\n\n      if ((res.totalHits - (queryParams.page * queryParams.per_page)) < 0) {\n        refs.gallery.insertAdjacentHTML(\"beforeend\", createMarkup(res.hits));\n        hideButton();\n        createMessage(\"We're sorry, but you've reached the end of search results\");\n        scrollBy();\n\n      } else if (res.hits.length > 0) {\n        refs.gallery.insertAdjacentHTML(\"beforeend\", createMarkup(res.hits));\n        scrollBy();\n        return;\n      } \n      \n    simplyGallery.refresh();\n    refs.form.reset();\n      \n    } catch (error) {\n      createMessage(\"Sorry, there is a problem with connection with the server\");\n    \n    } finally {\n      hideLoader();\n      refs.form.reset();\n      if (queryParams.page === queryParams.maxPage) {\n        createMessage(\"We're sorry, but you've reached the end of search results!\");\n      }\n    }\n}\n      \nfunction createMessage(message) {\n    iziToast.show({\n      class: 'error-svg',\n      position: 'topRight',\n      icon: 'error-svg',\n      message: message,\n      maxWidth: '432',\n      messageColor: '#fff',\n      messageSize: '16px',\n      backgroundColor: '#4e75ff',\n      close: false,\n      closeOnClick: true,\n      fontfamily: 'Montserrat', \n      fontsize: '16px',\n    });\n}\n  \nfunction hideLoader() {\n      setTimeout(() => {\n        refs.loader.style.display = 'none';\n      }, 1000);\n    };\n\n  function showLoader() {\n      refs.loader.style.display = 'block';\n    };\n  \n  function hideButton() {\n      refs.button.style.display = 'none';\n    }\n\n  function showButton() {\n      refs.button.style.display = 'block';;\n    }  \n\n \n  \n  \n\n"],"names":["refs","getImages","query","page","BASE_URL","API_KEY","createMarkup","hits","webformatURL","largeImageURL","tags","likes","views","comments","downloads","scrollBy","simplyGallery","SimpleLightbox","queryParams","handleSearch","handleLoadMore","event","showLoader","hideButton","createMessage","hideLoader","res","showButton","message","iziToast"],"mappings":"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"}