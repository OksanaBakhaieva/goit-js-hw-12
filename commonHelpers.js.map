{"version":3,"file":"commonHelpers.js","sources":["../src/js/refs.js","../src/js/pixayApi.js","../src/js/render-function","../src/js/scrollBy.js","../src/main.js"],"sourcesContent":["export const refs = {\n  form: document.querySelector('.form'),\n  input: document.querySelector('.input'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  searchBtn: document.querySelector('.button'),\n  btnMore: document.querySelector('.load-btn'),\n};","const BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '41991385-9b19b8bb3d6f1491499417d17';\n\nexport function getImages({ query, page = 1, per_page }) {\n    const url = `${BASE_URL}?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true`;\n  \n  return axios.get(url, {\n    params: {\n      page,\n      per_page,\n    }\n  })\n    .then(({data})=>data);\n}\n      \n\n\n","export function createMarkup(hits) {\n    return hits\n      .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) =>\n          `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n            <ul class=\"gallery-info\">\n              <li class=\"gallery-info-item\">Likes: <span class=\"descr-span\">${likes}</span></li>\n              <li class=\"gallery-info-item\">Views: <span class=\"descr-span\">${views}</span></li>\n              <li class=\"gallery-info-item\">Comments: <span class=\"descr-span\">${comments}</span></li>\n              <li class=\"gallery-info-item\">Downloads: <span class=\"descr-span\">${downloads}</span></li>\n            </ul> \n          </a>\n        </li>`\n      )\n    .join('');\n   \n}\n  \n","export function scrollBy() {\n  window.scrollBy({\n    top:\n      2 *\n      document.querySelector('.gallery-item').getBoundingClientRect().height,\n    behavior: 'smooth',\n  });\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { refs } from './js/refs';\nimport { getImages } from './js/pixayApi';\nimport { createMarkup } from './js/render-function';\nimport { scrollBy } from './js/scrollBy';\n\n\nconst simplyGallery = new SimpleLightbox('.gallery-item a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n});\n\nconst queryParams = {\n  query: '',\n  page: 1,\n  maxPage: 0,\n  per_page: 15,\n};\n\nrefs.form.addEventListener('submit', handleSearch);\nasync function handleSearch(event) {\n  event.preventDefault();\n  refs.gallery.innerHTML = '';\n\n  queryParams.page = 1;\n  const query = refs.input.value.trim();\n  \n  showLoader();\n  showButton();\n  if (!query) {\n    createMessage(\"The search field can't be empty! Please, enter your request!\");\n    return;\n    hideLoader();\n  }\n\n  function createMessage(message) {\n    iziToast.show({\n      class: 'error-svg',\n      position: 'topRight',\n      icon: 'error-svg',\n      message: message,\n      maxWidth: '432',\n      messageColor: '#fff',\n      messageSize: '16px',\n      backgroundColor: '#EF4040',\n      close: false,\n      closeOnClick: true,\n    });\n  }\n\n  try {\n    const {hits, totalHits } = await getImages(queryParams);\n    queryParams.maxPage = Math.ceil(totalHits / queryParams.per_page);\n      \n    refs.gallery.insertAdjacentHTML('beforeend', createMarkup(hits));\n    gallery.refresh();\n\n    if (hits.length === 0) {\n      createMessage(\"Sorry, there are no images matching your search query. Please, try again!\");\n      hideLoader();\n      hideButton();\n    } else if (hits.length > 0 && hits.length !== totalHits) {\n      showButton();\n      refs.btnMore.addEventListener('click', handleLoadMore);\n    } else {\n      hideButton();\n      createMessage(\"We are sorry, but you've reached the end of search results\");\n    }\n  } catch (error) {\n    createMessage(\"Sorry, there is a problem with connection with the server\");\n  } finally {\n    hideLoader();\n    refs.form.reset();\n    scrollBy();\n  }\n\n  \n  async function handleLoadMore() {\n    queryParams.page += 1;\n    showLoader();\n    refs.btnMore.disabled = true;\n    try {\n      const { hits } = await getImages(queryParams);\n\n      refs.gallery.insertAdjacentHTML('beforeend', createMarkup(hits));\n      refs.gallery.refresh();\n\n      if (data.hits.length > 0) {\n        showButton();\n        refs.btnMore.addEventListener('click', handleLoadMore);\n      } else {\n        hideButton();\n        createMessage(\"We're sorry, but you've reached the end of search results\");\n      }\n    } catch (error) {\n      createMessage(\"Sorry, there is a problem with connection with the server\");\n    } finally {\n      hideLoader();\n      refs.btnMore.disabled = false;\n            \n      if (queryParams.page === queryParams.maxPage) {\n        createMessage(\"We are sorry, but you've reached the end of search results\");\n        hideButton();\n        refs.btnMore.removeEventListener('click', handleLoadMore);\n      }\n      scrollBy();\n    }\n  }\n\n  function hideLoader() {\n    setTimeout(() => {\n        refs.loader.classList.add('hidden');\n        }, 500);\n  };\n\n  function showLoader() {\n        refs.loader.classList.remove('hidden');\n  };\n  \n  function hideButton() {\n    setTimeout(() => {\n        refs.btnMore.classList.add('hidden');\n        }, 500);\n  };\n\n  function showButton() {\n        refs.btnMore.classList.remove('hidden');\n  };\n}\n"],"names":["refs","BASE_URL","API_KEY","getImages","query","page","per_page","url","data","createMarkup","hits","webformatURL","largeImageURL","tags","likes","views","comments","downloads","scrollBy","SimpleLightbox","queryParams","handleSearch","event","showLoader","showButton","createMessage","message","iziToast","totalHits","hideLoader","hideButton","handleLoadMore"],"mappings":"6vBAAO,MAAMA,EAAO,CAClB,KAAM,SAAS,cAAc,OAAO,EACpC,MAAO,SAAS,cAAc,QAAQ,EACtC,QAAS,SAAS,cAAc,UAAU,EAC1C,OAAQ,SAAS,cAAc,SAAS,EACxC,UAAW,SAAS,cAAc,SAAS,EAC3C,QAAS,SAAS,cAAc,WAAW,CAC7C,ECPMC,EAAW,2BACXC,EAAU,qCAET,SAASC,EAAU,CAAE,MAAAC,EAAO,KAAAC,EAAO,EAAG,SAAAC,CAAQ,EAAI,CACrD,MAAMC,EAAM,GAAGN,SAAgBC,OAAaE,4DAE9C,OAAO,MAAM,IAAIG,EAAK,CACpB,OAAQ,CACN,KAAAF,EACA,SAAAC,CACD,CACL,CAAG,EACE,KAAK,CAAC,CAAC,KAAAE,CAAI,IAAIA,CAAI,CACxB,CCbO,SAASC,EAAaC,EAAM,CAC/B,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,IACC;AAAA;AAAA,0CAEgCL;AAAA;AAAA;AAAA,qBAGrBD;AAAA,qBACAE;AAAA;AAAA;AAAA,8EAGyDC;AAAA,8EACAC;AAAA,iFACGC;AAAA,kFACCC;AAAA;AAAA;AAAA,cAI3E,EACF,KAAK,EAAE,CAEZ,CC/BO,SAASC,GAAW,CACzB,OAAO,SAAS,CACd,IACE,EACA,SAAS,cAAc,eAAe,EAAE,sBAAuB,EAAC,OAClE,SAAU,QACd,CAAG,CACH,CCGsB,IAAIC,EAAe,kBAAmB,CACpD,aAAc,MACd,aAAc,GACtB,CAAC,EAED,MAAMC,EAAc,CAClB,MAAO,GACP,KAAM,EACN,QAAS,EACT,SAAU,EACZ,EAEApB,EAAK,KAAK,iBAAiB,SAAUqB,CAAY,EACjD,eAAeA,EAAaC,EAAO,CACjCA,EAAM,eAAc,EACpBtB,EAAK,QAAQ,UAAY,GAEzBoB,EAAY,KAAO,EACnB,MAAMhB,EAAQJ,EAAK,MAAM,MAAM,KAAI,EAInC,GAFAuB,IACAC,IACI,CAACpB,EAAO,CACVqB,EAAc,8DAA8D,EAC5E,MAED,CAED,SAASA,EAAcC,EAAS,CAC9BC,EAAS,KAAK,CACZ,MAAO,YACP,SAAU,WACV,KAAM,YACN,QAASD,EACT,SAAU,MACV,aAAc,OACd,YAAa,OACb,gBAAiB,UACjB,MAAO,GACP,aAAc,EACpB,CAAK,CACF,CAED,GAAI,CACF,KAAM,CAAC,KAAAhB,EAAM,UAAAkB,CAAS,EAAK,MAAMzB,EAAUiB,CAAW,EACtDA,EAAY,QAAU,KAAK,KAAKQ,EAAYR,EAAY,QAAQ,EAEhEpB,EAAK,QAAQ,mBAAmB,YAAaS,EAAaC,CAAI,CAAC,EAC/D,QAAQ,QAAO,EAEXA,EAAK,SAAW,GAClBe,EAAc,2EAA2E,EACzFI,IACAC,KACSpB,EAAK,OAAS,GAAKA,EAAK,SAAWkB,GAC5CJ,IACAxB,EAAK,QAAQ,iBAAiB,QAAS+B,CAAc,IAErDD,IACAL,EAAc,4DAA4D,EAE7E,MAAC,CACAA,EAAc,2DAA2D,CAC7E,QAAY,CACRI,IACA7B,EAAK,KAAK,QACVkB,GACD,CAGD,eAAea,GAAiB,CAC9BX,EAAY,MAAQ,EACpBG,IACAvB,EAAK,QAAQ,SAAW,GACxB,GAAI,CACF,KAAM,CAAE,KAAAU,CAAM,EAAG,MAAMP,EAAUiB,CAAW,EAE5CpB,EAAK,QAAQ,mBAAmB,YAAaS,EAAaC,CAAI,CAAC,EAC/DV,EAAK,QAAQ,UAET,KAAK,KAAK,OAAS,GACrBwB,IACAxB,EAAK,QAAQ,iBAAiB,QAAS+B,CAAc,IAErDD,IACAL,EAAc,2DAA2D,EAE5E,MAAC,CACAA,EAAc,2DAA2D,CAC/E,QAAc,CACRI,IACA7B,EAAK,QAAQ,SAAW,GAEpBoB,EAAY,OAASA,EAAY,UACnCK,EAAc,4DAA4D,EAC1EK,IACA9B,EAAK,QAAQ,oBAAoB,QAAS+B,CAAc,GAE1Db,GACD,CACF,CAED,SAASW,GAAa,CACpB,WAAW,IAAM,CACb7B,EAAK,OAAO,UAAU,IAAI,QAAQ,CACjC,EAAE,GAAG,CAEd,CACE,SAASuB,GAAa,CAChBvB,EAAK,OAAO,UAAU,OAAO,QAAQ,CAE7C,CACE,SAAS8B,GAAa,CACpB,WAAW,IAAM,CACb9B,EAAK,QAAQ,UAAU,IAAI,QAAQ,CAClC,EAAE,GAAG,CAEd,CACE,SAASwB,GAAa,CAChBxB,EAAK,QAAQ,UAAU,OAAO,QAAQ,CAE9C,CAAA"}